#############################################################################
#
# Copyright (c) 2018 AT&T Intellectual Property. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#        http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
#############################################################################
version: '2.1'
services:

   inventory:
      image: "{{ nexus_docker_repo }}/onap/org.onap.dcaegen2.platform.inventory-api:{{ dcae_docker_inv }}"
      restart: always
      container_name: "inventory"
      hostname: "inventory"
      environment:
       - "POSTGRES_USER=inventory"
       - "POSTGRES_PASSWORD=inventorypwd"
      ports:
       - "8080:8080"
      labels:
       - "SERVICE_8080_NAME=inventory"
       - "SERVICE_8080_CHECK_HTTP=/dcae-service-types"
       - "SERVICE_8080_CHECK_INTERVAL=15s"
       - "SERVICE_8080_CHECK_INITIAL_STATUS=passing"


   service-change-handler:
      image: "{{ nexus_docker_repo }}/onap/org.onap.dcaegen2.platform.servicechange-handler:{{ dcae_docker_sch }}"
      container_name: "service-change-handler"
      hostname: "service-change-handler"
      ports:
       - "8079:8079"
      environment:
       - "POSTGRES_USER=inventory"
       - "POSTGRES_PASSWORD=inventorypwd"
      labels:
       - "SERVICE_NAME=service_change_handler"
       - "SERVICE_CHECK_SCRIPT=/opt/health.sh"
       - "SERVICE_CHECK_INTERVAL=15s"
       - "SERVICE_CHECK_INITIAL_STATUS=passing"


   deployment_handler:
      image: "{{ nexus_docker_repo }}/onap/org.onap.dcaegen2.platform.deployment-handler:{{ dcae_docker_dh }}"
      restart: always
      container_name: "deployment-handler"
      hostname: "deployment-handler"
      environment:
       - "CLOUDIFY_PASSWORD=admin"
       - "CLOUDIFY_USER=admin"
      ports:
       - "8188:8443"
      labels:
       - "SERVICE_8443_NAME=deployment_handler"
       - "SERVICE_8443_CHECK_HTTP=/"
       - "SERVICE_8443_CHECK_INTERVAL=15s"
       - "SERVICE_8443_CHECK_INITIAL_STATUS=passing"


   policy_handler:
      image: "{{ nexus_docker_repo }}/onap/org.onap.dcaegen2.platform.policy-handler:{{ dcae_docker_ph }}"
      restart: always
      container_name: "policy-handler"
      hostname: "policy-handler"
      ports:
       - "25577:25577"
      labels:
       - "SERVICE_25577_NAME=policy_handler"
       - "SERVICE_25577_CHECK_HTTP=/healthcheck"
       - "SERVICE_25577_CHECK_INTERVAL=15s"
       - "SERVICE_25577_CHECK_INITIAL_STATUS=passing"

